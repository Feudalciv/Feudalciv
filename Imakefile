XCOMM Imakefile for Freeciv
XCOMM This program is free software; you can redistribute it and/or modify
XCOMM it under the terms of the GNU General Public License as published by
XCOMM the Free Software Foundation; either version 2, or (at your option)
XCOMM any later version.
XCOMM This program is distributed in the hope that it will be useful,
XCOMM but WITHOUT ANY WARRANTY; without even the implied warranty of
XCOMM MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
XCOMM GNU General Public License for more details.
XCOMM You should have received a copy of the GNU General Public License
XCOMM along with this program; if not, write to the Free Software
XCOMM Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.

XCOMM uncomment and specify your compiler below if you get an error
XCOMM about an unknown command 'cc' or 'gcc'.
XCOMM This typically happens under Solaris, where 'cc' isn't distributed
XCOMM as a default component anymore. (Use gcc instead, it's better!  gcc
XCOMM can be FTPed from ftp://ftp.gnu.org/pub/gnu )
XCOMM
XCOMM CC = gcc

XCOMM if your Xpm library/includes are located in a non-standard directory
XCOMM then specify it below - follow the /users/pjunold example below.
XCOMM
XPM_INCLUDE_DIR=/usr/include/X11
XCOMM XPM_INCLUDE_DIR=/users/pjunold/xpm-3.4i/lib
XCOMM XPM_LIB_DIR=-L/users/pjunold/xpm-3.4i/lib

/**/# if you get compile errors related to socket/connect etc syscalls
/**/# then uncomment the line below                                    
/**/# SOCKLIB = -lsocket

PROGRAMS = civclient civserver
INCLUDES = -Iserver -Iclient -Icommon -Iai -I$(XPM_INCLUDE_DIR) 

SERVER_OBJS= server/civserver.o server/sernet.o server/unithand.o \
	     server/unitfunc.o server/unittools.o server/autoattack.o \
             server/maphand.o server/stdinhand.o server/cityhand.o \
	     server/plrhand.o server/handchat.o server/gamehand.o \
	     server/gotohand.o server/diplhand.o server/meta.o \
	     server/registry.o server/mapgen.o server/cityturn.o \
	     server/citytools.o server/settlers.o server/gamelog.o \
	     server/ruleset.o server/spacerace.o \
	     ai/aihand.o ai/aitools.o ai/aicity.o ai/aiunit.o ai/aitech.o \
	     ai/advleader.o ai/advmilitary.o ai/advtrade.o ai/advscience.o \
	     ai/advdomestic.o ai/advforeign.o ai/advattitude.o ai/advisland.o

CLIENT_OBJS= client/civclient.o client/xmain.o client/canvas.o client/menu.o \
	     client/colors.o client/graphics.o  client/mapview.o \
	     client/chatline.o client/clinet.o client/dialogs.o  \
             client/plrdlg.o client/mapctrl.o  client/citydlg.o \
	     client/repodlgs.o client/ratesdlg.o client/xstuff.o \
	     client/inputdlg.o client/finddlg.o client/helpdlg.o \
	     client/diplodlg.o client/pixcomm.o client/optiondlg.o \
	     client/messagedlg.o client/messagewin.o client/inteldlg.o \
	     client/resources.o client/climisc.o client/packhand.o \
	     client/gotodlg.o client/connectdlg.o client/spaceshipdlg.o \
	     client/cityrep.o

COMMON_OBJS= common/log.o common/map.o common/packets.o common/shared.o \
             common/unit.o common/player.o common/game.o common/genlist.o \
	     common/tech.o common/city.o common/diptreaty.o \
	     common/capability.o common/spaceship.o


OBJS1 = $(CLIENT_OBJS) $(COMMON_OBJS)
OBJS2 = $(SERVER_OBJS) $(COMMON_OBJS)

CLI_LIBS = $(XPM_LIB_DIR) -lXpm XawClientLibs $(SOCKLIB) 
SER_LIBS = $(SOCKLIB) 

.c.o:
	$(CC) $(CFLAGS) -c $< -o $@

ComplexProgramTarget_1(civclient, $(CLI_LIBS), $(SYSLIBS))
ComplexProgramTarget_2(civserver, $(SER_LIBS), $(SYSLIBS))

clean::
	$(RM) $(OBJS1) $(OBJS2)

client/resources.o: client/Freeciv.h
client/Freeciv.h: data/Freeciv
	echo '/***********************************************/' > $@
	echo '/* DO NOT EDIT THIS FILE, EDIT ../data/Freeciv */' >> $@
	echo '/***********************************************/' >> $@
	client/ad2c $? >> $@

